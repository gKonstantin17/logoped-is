<div class="lessons-container">
  <!-- Sidebar: dropdown -->
  <aside class="sidebar">
    <select id="childSelect" [(ngModel)]="selectedChildId">
      <option [ngValue]="0">-- Все дети --</option>
      <option *ngFor="let child of childrenData" [ngValue]="child.id">
        {{ child.firstName }} {{ child.lastName }}
      </option>
    </select>

  </aside>

  <!-- Main content -->
  <div class="main-content">
    <h1>Логопедические занятия</h1>


    <!-- Кнопка всегда видна, если логопед -->
    <div *ngIf="currentRole === 'logoped'" class="add-lessons-btn-container">
      <button class="add-lessons-btn" (click)="openModal()">Подобрать занятия</button>
    </div>

      <div class="add-lessons-btn-container" *ngIf="upcomingLessons.length === 0">
        <button class="add-lessons-btn" (click)="openModal()">Подобрать занятия</button>
      </div>


    <app-lesson-modal
      *ngIf="showModal"
      [hasSpeechCard]="hasSpeechCard"
      [currentRole]="currentRole"
      (closeModal)="showModal = false"
      (confirmBooking)="handleBooking($event)"
      [patientId]="selectedChildId">

    </app-lesson-modal>

      <div *ngIf="upcomingLessons.length > 0">
        <h2>Предстоящие занятия</h2>
        <div class="lesson-cards">
          <div class="lesson-card upcoming" *ngFor="let lesson of upcomingLessons">
            <div class="card-top">
              <div class="icon-wrapper">
                <ng-container *ngIf="lesson.type === 'Диагностика'; else regularIcon">
                  <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="75" height="75"><path d="M9.5,12h-1v-.619c0-1.005,.657-2.184,1.464-2.628,.762-.42,1.156-1.252,1.003-2.119-.14-.802-.798-1.46-1.601-1.602-.603-.104-1.191,.048-1.652,.436-.454,.381-.714,.939-.714,1.532h-1c0-.889,.391-1.727,1.071-2.298s1.58-.812,2.468-.654c1.209,.212,2.201,1.204,2.413,2.413,.224,1.273-.381,2.547-1.506,3.168-.496,.273-.947,1.107-.947,1.752v.619Zm.5,2h0c0-.552-.448-1-1-1h0c-.552,0-1,.448-1,1h0c0,.552,.448,1,1,1h0c.552,0,1-.448,1-1Zm9.996-4.92c-.003,.382-.025,.759-.066,1.131,1.852,1.261,3.07,3.385,3.07,5.789v7h-7c-2.404,0-4.528-1.219-5.789-3.07-.372,.041-.749,.064-1.131,.066,1.385,2.389,3.965,4.004,6.92,4.004h8v-8c0-2.955-1.615-5.535-4.004-6.92Zm-1.996-.08C18,4.037,13.963,0,9,0S0,4.037,0,9v9H9c4.963,0,9-4.037,9-9ZM1,9C1,4.589,4.589,1,9,1s8,3.589,8,8-3.589,8-8,8H1V9Z"/></svg>
                </ng-container>
                <ng-template #regularIcon>
                  <svg id="Layer_1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" width="75" height="75"><path d="m0 24 6.324-3.5-6.324-3.513zm1-5.314 3.266 1.814-3.266 1.814zm7 1.314h16v1h-16zm6-9v7h2.75c1.24 0 2.25-1.009 2.25-2.25s-1.01-2.25-2.25-2.25h-1.75v-2.5zm2.75 3.5c.689 0 1.25.561 1.25 1.25s-.561 1.25-1.25 1.25h-1.75v-2.5zm-7-4.5h-2.75v8h3.75c1.24 0 2.25-1.009 2.25-2.25 0-.97-.617-1.798-1.479-2.114.3-.382.479-.864.479-1.386 0-1.241-1.01-2.25-2.25-2.25zm-1.75 1h1.75c.689 0 1.25.561 1.25 1.25s-.561 1.25-1.25 1.25h-1.75zm4 4.75c0 .689-.561 1.25-1.25 1.25h-2.75v-2.5h2.75c.689 0 1.25.561 1.25 1.25zm9.5-15.75h-19c-1.379 0-2.5 1.122-2.5 2.5v12.199l1 .555v-7.254h22v10h1v-15.5c0-1.378-1.121-2.5-2.5-2.5zm-20.5 7v-4.5c0-.827.673-1.5 1.5-1.5h19c.827 0 1.5.673 1.5 1.5v4.5zm4-3c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1zm3 0c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1zm3 0c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1z"/></svg>
                </ng-template>
              </div>
            </div>
            <div class="card-bottom">
              <p><strong>Тип:</strong> {{ lesson.type }}</p>
              <p><strong>Дата занятия:</strong> {{ lesson.dateOfLesson | date:'dd.MM.yyyy HH:mm' }}</p>
              <p *ngIf="lesson.homeworkId !== null">
                <strong>Домашнее задание:</strong> {{ lesson.homework ? 'задано' : 'нет заданий'}}
              </p>
              <a class="to-details" [routerLink]="['/dashboard/details', lesson.id]">Подробнее</a>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="pastLessons.length > 0" style="margin-top: 40px;">
        <h2>Прошедшие занятия</h2>
        <div class="lesson-cards">
          <div class="lesson-card past" *ngFor="let lesson of pastLessons">
            <div class="card-top">
              <div class="icon-wrapper">
                <ng-container *ngIf="lesson.type === 'Диагностика'; else regularIcon">
                  <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="75" height="75"><path d="M9.5,12h-1v-.619c0-1.005,.657-2.184,1.464-2.628,.762-.42,1.156-1.252,1.003-2.119-.14-.802-.798-1.46-1.601-1.602-.603-.104-1.191,.048-1.652,.436-.454,.381-.714,.939-.714,1.532h-1c0-.889,.391-1.727,1.071-2.298s1.58-.812,2.468-.654c1.209,.212,2.201,1.204,2.413,2.413,.224,1.273-.381,2.547-1.506,3.168-.496,.273-.947,1.107-.947,1.752v.619Zm.5,2h0c0-.552-.448-1-1-1h0c-.552,0-1,.448-1,1h0c0,.552,.448,1,1,1h0c.552,0,1-.448,1-1Zm9.996-4.92c-.003,.382-.025,.759-.066,1.131,1.852,1.261,3.07,3.385,3.07,5.789v7h-7c-2.404,0-4.528-1.219-5.789-3.07-.372,.041-.749,.064-1.131,.066,1.385,2.389,3.965,4.004,6.92,4.004h8v-8c0-2.955-1.615-5.535-4.004-6.92Zm-1.996-.08C18,4.037,13.963,0,9,0S0,4.037,0,9v9H9c4.963,0,9-4.037,9-9ZM1,9C1,4.589,4.589,1,9,1s8,3.589,8,8-3.589,8-8,8H1V9Z"/></svg>
                </ng-container>
                <ng-template #regularIcon>
                  <svg id="Layer_1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" width="75" height="75"><path d="m0 24 6.324-3.5-6.324-3.513zm1-5.314 3.266 1.814-3.266 1.814zm7 1.314h16v1h-16zm6-9v7h2.75c1.24 0 2.25-1.009 2.25-2.25s-1.01-2.25-2.25-2.25h-1.75v-2.5zm2.75 3.5c.689 0 1.25.561 1.25 1.25s-.561 1.25-1.25 1.25h-1.75v-2.5zm-7-4.5h-2.75v8h3.75c1.24 0 2.25-1.009 2.25-2.25 0-.97-.617-1.798-1.479-2.114.3-.382.479-.864.479-1.386 0-1.241-1.01-2.25-2.25-2.25zm-1.75 1h1.75c.689 0 1.25.561 1.25 1.25s-.561 1.25-1.25 1.25h-1.75zm4 4.75c0 .689-.561 1.25-1.25 1.25h-2.75v-2.5h2.75c.689 0 1.25.561 1.25 1.25zm9.5-15.75h-19c-1.379 0-2.5 1.122-2.5 2.5v12.199l1 .555v-7.254h22v10h1v-15.5c0-1.378-1.121-2.5-2.5-2.5zm-20.5 7v-4.5c0-.827.673-1.5 1.5-1.5h19c.827 0 1.5.673 1.5 1.5v4.5zm4-3c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1zm3 0c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1zm3 0c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1z"/></svg>
                </ng-template>
              </div>
            </div>
            <div class="card-bottom">
              <p><strong>Тип:</strong> {{ lesson.type }}</p>
              <p><strong>Дата занятия:</strong> {{ lesson.dateOfLesson | date:'dd.MM.yyyy HH:mm' }}</p>
              <p *ngIf="lesson.homeworkId !== null">
                <strong>Домашнее задание:</strong> {{ lesson.homework ? 'задано' : 'нет заданий'}}
              </p>
              <a [routerLink]="['/dashboard/details', lesson.id]">Подробнее</a>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="cancelledLessons.length > 0" style="margin-top: 40px;">
        <h2>Отменённые занятия</h2>
        <div class="lesson-cards">
          <div class="lesson-card cancelled" *ngFor="let lesson of cancelledLessons">
            <div class="card-top">
              <div class="icon-wrapper">
                <ng-container *ngIf="lesson.type === 'Диагностика'; else regularIcon">
                  <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="75" height="75"><path d="M9.5,12h-1v-.619c0-1.005,.657-2.184,1.464-2.628,.762-.42,1.156-1.252,1.003-2.119-.14-.802-.798-1.46-1.601-1.602-.603-.104-1.191,.048-1.652,.436-.454,.381-.714,.939-.714,1.532h-1c0-.889,.391-1.727,1.071-2.298s1.58-.812,2.468-.654c1.209,.212,2.201,1.204,2.413,2.413,.224,1.273-.381,2.547-1.506,3.168-.496,.273-.947,1.107-.947,1.752v.619Zm.5,2h0c0-.552-.448-1-1-1h0c-.552,0-1,.448-1,1h0c0,.552,.448,1,1,1h0c.552,0,1-.448,1-1Zm9.996-4.92c-.003,.382-.025,.759-.066,1.131,1.852,1.261,3.07,3.385,3.07,5.789v7h-7c-2.404,0-4.528-1.219-5.789-3.07-.372,.041-.749,.064-1.131,.066,1.385,2.389,3.965,4.004,6.92,4.004h8v-8c0-2.955-1.615-5.535-4.004-6.92Zm-1.996-.08C18,4.037,13.963,0,9,0S0,4.037,0,9v9H9c4.963,0,9-4.037,9-9ZM1,9C1,4.589,4.589,1,9,1s8,3.589,8,8-3.589,8-8,8H1V9Z"/></svg>
                </ng-container>
                <ng-template #regularIcon>
                  <svg id="Layer_1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" width="75" height="75"><path d="m0 24 6.324-3.5-6.324-3.513zm1-5.314 3.266 1.814-3.266 1.814zm7 1.314h16v1h-16zm6-9v7h2.75c1.24 0 2.25-1.009 2.25-2.25s-1.01-2.25-2.25-2.25h-1.75v-2.5zm2.75 3.5c.689 0 1.25.561 1.25 1.25s-.561 1.25-1.25 1.25h-1.75v-2.5zm-7-4.5h-2.75v8h3.75c1.24 0 2.25-1.009 2.25-2.25 0-.97-.617-1.798-1.479-2.114.3-.382.479-.864.479-1.386 0-1.241-1.01-2.25-2.25-2.25zm-1.75 1h1.75c.689 0 1.25.561 1.25 1.25s-.561 1.25-1.25 1.25h-1.75zm4 4.75c0 .689-.561 1.25-1.25 1.25h-2.75v-2.5h2.75c.689 0 1.25.561 1.25 1.25zm9.5-15.75h-19c-1.379 0-2.5 1.122-2.5 2.5v12.199l1 .555v-7.254h22v10h1v-15.5c0-1.378-1.121-2.5-2.5-2.5zm-20.5 7v-4.5c0-.827.673-1.5 1.5-1.5h19c.827 0 1.5.673 1.5 1.5v4.5zm4-3c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1zm3 0c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1zm3 0c0 .552-.448 1-1 1s-1-.448-1-1 .448-1 1-1 1 .448 1 1z"/></svg>
                </ng-template>
              </div>
            </div>
            <div class="card-bottom">
              <p><strong>Тип:</strong> {{ lesson.type }}</p>
              <p><strong>Дата занятия:</strong> {{ lesson.dateOfLesson | date:'dd.MM.yyyy HH:mm' }}</p>
              <p *ngIf="lesson.homeworkId !== null">
                <strong>Домашнее задание:</strong> {{ lesson.homework ? 'задано' : 'нет заданий'}}
              </p>
              <a [routerLink]="['/dashboard/details', lesson.id]">Подробнее</a>
            </div>
          </div>
        </div>
      </div>

    <div *ngIf="toastMessage" class="toast">
      {{ toastMessage }}
    </div>


  </div>
</div>
